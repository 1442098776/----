<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.shop.eshop.mapper.OrderManageMapper">
    <resultMap id="orderManageMap" type="com.shop.eshop.dto.OrderVo">
        <id column="id" jdbcType="BIGINT" property="id" />
        <result column="order_id" jdbcType="BIGINT" property="orderId" />
        <result column="user_id" jdbcType="BIGINT" property="userId" />
        <result column="receive_address" jdbcType="BIGINT" property="receiveAddress" />
        <result column="create_time" jdbcType="TIMESTAMP" property="createTime" />
        <result column="send_time" jdbcType="TIMESTAMP" property="sendTime" />
        <result column="receive_time" jdbcType="TIMESTAMP" property="receiveTime" />
        <result column="cancel_time" jdbcType="TIMESTAMP" property="cancelTime" />
        <result column="state" jdbcType="INTEGER" property="state" />
        <result column="message" jdbcType="VARCHAR" property="message" />
        <collection property="orderDetailVoList" ofType="com.shop.eshop.dto.OrderDetailVo" column="order_id" select="getOrderDetailByOrderId"/>
    </resultMap>

    <resultMap id="OrderDetailManage" type="com.shop.eshop.dto.OrderDetailVo">
        <id column="order_id" jdbcType="BIGINT" property="orderId" />
        <!--<result column="good_id" jdbcType="BIGINT" property="goodId" />-->
        <result column="good_count" jdbcType="INTEGER" property="goodCount" />
        <result column="good_price" jdbcType="FLOAT" property="goodPrice" />
        <association property="good" javaType="com.shop.eshop.model.Good" column="good_id" select="com.shop.eshop.mapper.GoodMapper.getGoodById"/>
    </resultMap>
    
    <select id="getAllOrder" parameterType="java.lang.Long" resultMap="orderManageMap">
        SELECT * from `order` where user_id = #{userId}
    </select>
    
    <select id="getOrderDetailByOrderId" parameterType="java.lang.Long" resultMap="OrderDetailManage">
        select * from `order_detail` where order_id = #{orderId}
    </select>
</mapper>